@()(implicit req: RequestHeader)

@helper.javascriptRouter("routes")(
    routes.javascript.Swagger.generate
)

@main("Swagger2Postman", moreScripts = knockout()) {
<div class="row">
    <form role="form" class="form-horizontal col-md-6">
        <h4>Swagger2Postman</h4>
        @htmlControl("Swagger Host"){
            <div class="col-md-9">
                <input class="form-control" type="text" data-bind="value: host"/>
            </div>
        }
        @htmlControl("Swagger Version"){
            <div class="col-md-9">
                <select class="form-control">
                    <option>1.2</option>
                </select>
            </div>
        }
        @htmlControl("Collection Name"){
            <div class="col-md-9">
                <input class="form-control" type="text" data-bind="value: name"/>
            </div>
        }
        <button class="btn" data-bind="click: generate">Generate Postman</button>
    </form>
    <div class="col-md-6">
        <h4>Postman JSON</h4>
        @htmlControl(""){
        <textarea data-bind="value: postman" rows="20" class="col-md-12" placeholder="Postman JSON result"></textarea>
        }
    </div>
</div>
}

<script>
function Swagger(){
    var self = this;
    self.host = ko.observable();
    self.name = ko.observable();
    self.headers = ko.observable({});
    self.postman = ko.observable();

    self.generate = function(){
        routes.controllers.Swagger.generate().ajax({
            data: ko.toJSON(self),
            contentType: 'text/json',
            success: function(data){
                self.postman(JSON.stringify(data));
            },
            error: function(data){
                console.log(data);
            }
        });
    }
}

var swagger = new Swagger();
ko.applyBindings(swagger);
</script>
